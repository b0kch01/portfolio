<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Awesome People!</title>
        <link rel="stylesheet" href="/assets/css/styles.css" />

        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#475569" />
        <meta name="msapplication-TileColor" content="#475569" />
        <meta name="theme-color" content="#ffffff" />
    </head>
    <body class="open--sesame">
        <div class="everything">
            <section id="note">
                <img
                    class="mr-1 spin fadein"
                    src="/assets/images/icons/gift.svg"
                    width="55"
                />
                <h1 id="name" class="fadein">Awesome People</h1>

                <h3 class="fadein">I have a special message for you!</h3>

                <hr />

                <p id="words">Trying to remember what I said > . <</p>
            </section>
        </div>

        <script>
            (function () {
                const personData = window.location.search
                    .substring(3)
                    .split("-");

                const name = personData[0] + " " + personData[1];
                const notionLink =
                    "https://nathansawesomepeople.vercel.app/html/?id=" +
                    personData[2];

                document.querySelector("#name").innerHTML = name;

                fetch(notionLink)
                    .then((response) => response.text())
                    .then((html) => {
                        if (html.includes("A server error has occurred")) {
                            window.location.href =
                                "https://nathanchoi.me/awesome-people/note/?p=" +
                                prompt("Enter page ID:");
                        } else {
                            document.querySelector("#words").innerHTML = html;
                        }
                    });

                console.log(name, notionLink);
            })();
        </script>
    </body>
</html>
